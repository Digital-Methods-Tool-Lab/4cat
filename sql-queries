
# Get post counts per month
sudo su - 4cat
psql --dbmame=fourcat
COPY ( SELECT to_char(to_timestamp(posts_4chan.timestamp), 'YYYY-MM') AS month_string, count(*) AS count FROM posts_4chan INNER JOIN threads_4chan ON threads_4chan.id = posts_4chan.thread_id WHERE threads_4chan.board = 'pol' GROUP BY month_string ) TO '/mnt/bigstorage/psql_files/count_per_month3.csv' WITH HEADER CSV DELIMITER ',';


# Get post counts per month (only OP)
sudo su - 4cat
psql --dbmame=fourcat
COPY ( SELECT to_char(to_timestamp(posts_4chan.timestamp), 'YYYY-MM') AS month_string, count(*) AS count FROM posts_4chan INNER JOIN threads_4chan ON threads_4chan.id = posts_4chan.id WHERE threads_4chan.board = 'pol' GROUP BY month_string ) TO '/mnt/bigstorage/psql_files/count_per_month_op_only.csv' WITH HEADER CSV DELIMITER ',';